#pragma once
#include "LargeFlowCounter.h"

class LargeFlowIdentifier
{
private:	
	LFCounter * counter;
public:
	/**	大流统计器默认构造器
	*/
	LargeFlowIdentifier(LFCounter * lfCounter);
	~LargeFlowIdentifier();
	
	/** 统计大流
	*/
	void insert(const FlowID & fid);

	bool insertAndSetCounter(const FlowID& fid, const ULONG count);


	/**
	*	尝试增加正票
	*/
	bool incr(const FlowID& fid);

	/** 获取大流集合
	* @return 大流集合
	*/
	void getLargeFlowList(list<ULONG> &);

	void getLargeFlowNumList(list<ULONG>&, list<ULONG>&);

	ULONG getFlowNum(const FlowID & fid);
};

